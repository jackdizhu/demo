## [查询选择器](https://docs.mongodb.com/manual/reference/operator/query/)

### 比较

|名称|描述|
|--|--|
|$eq	|匹配等于指定值的值。|
|$gt	|匹配大于指定值的值。|
|$gte	|匹配大于或等于指定值的值。|
|$in	|匹配数组中指定的任何值。|
|$lt	|匹配小于指定值的值。|
|$lte	|匹配小于或等于指定值的值。|
|$ne	|匹配所有不等于指定值的值。|
|$nin	|不匹配数组中指定的任何值。|

### 逻辑

|名称|描述|
|--|--|
|$and	|使用逻辑连接查询子句AND将返回与两个子句的条件匹配的所有文档。|
|$not	|反转查询表达式的效果并返回与查询表达式不匹配的文档。|
|$nor	|使用逻辑连接查询子句NOR将返回所有无法匹配两个子句的文档。|
|$or	|使用逻辑连接查询子句OR将返回与任一子句的条件匹配的所有文档。|

### 元素

|名称|描述|
|--|--|
|$exists	|匹配具有指定字段的文档。|
|$type	|如果字段是指定类型，则选择文档。|

### 求值

|名称|描述|
|--|--|
|$expr	|允许在查询语言中使用聚合表达式。|
|$jsonSchema	|根据给定的JSON模式验证文档。|
|$mod	|对字段的值执行模运算，并选择具有指定结果的文档。|
|$regex	|选择值与指定正则表达式匹配的文档。|
|$text	|执行文本搜索。|
|$where	|匹配满足JavaScript表达式的文档。|

### 地理空间

|名称|描述|
|--|--|
|$geoIntersects	|选择与GeoJSON几何体相交的几何。该2dsphere索引支持 $geoIntersects。|
|$geoWithin	|选择边界GeoJSON几何体内的几何。该2dsphere和2D索引支持 $geoWithin。|
|$near	|返回点附近的地理空间对象。需要地理空间索引。该2dsphere和2D索引支持 $near。|
|$nearSphere	|返回球体上某点附近的地理空间对象。需要地理空间索引。该2dsphere和2D索引支持 $nearSphere。|

### 数组

|名称|描述|
|--|--|
|$all	|匹配包含查询中指定的所有元素的数组。|
|$elemMatch	|如果数组字段中的元素与所有指定$elemMatch条件匹配，则选择文档。|
|$size	|如果数组字段是指定大小，则选择文档。|

### 按位

|名称|描述|
|--|--|
|$bitsAllClear	|匹配数值或二进制值，其中一组位位置都具有值0。|
|$bitsAllSet	|匹配数值或二进制值，其中一组位位置都具有值1。|
|$bitsAnyClear	|匹配数值或二进制值，其中来自一组位位置的任何位的值都为0。|
|$bitsAnySet	|匹配数值或二进制值，其中来自一组位位置的任何位的值都为1。|

### 评论

|名称|描述|
|--|--|
|$comment	|向查询谓词添加注释。|

### 投影操作

|名称|描述|
|--|--|
|$	|投影数组中与查询条件匹配的第一个元素。|
|$elemMatch	|投影数组中与指定$elemMatch条件匹配的第一个元素。|
|$meta	|投影在$text操作期间分配的文档分数。|
|$slice	|限制从数组投射的元素数量。支持跳过和限制切片。|

## [更新运算符](https://docs.mongodb.com/manual/reference/operator/update/)

### 字段

|名称|描述|
|--|--|
|$currentDate	|将字段的值设置为当前日期，可以是Date或Timestamp。|
|$inc	|按指定的数量增加字段的值。|
|$min	|仅当指定的值小于现有字段值时才更新字段。|
|$max	|仅当指定的值大于现有字段值时才更新字段。|
|$mul	|将字段的值乘以指定的量。|
|$rename	|重命名字段。|
|$set	|设置文档中字段的值。|
|$setOnInsert	|如果更新导致文档插入，则设置字段的值。对修改现有文档的更新操作没有影响。|
|$unset	|从文档中删除指定的字段。|

### 数组

|名称|描述|
|--|--|
|$	|充当占位符以更新与查询条件匹配的第一个元素。|
|$[]	|充当占位符以更新数组中与查询条件匹配的文档中的所有元素。|
|$[<identifier>]	|充当占位符以更新与arrayFilters匹配查询条件的文档的条件匹配的所有元素。|
|$addToSet	|仅当数组中尚不存在元素时才将元素添加到数组中。|
|$pop	|删除数组的第一个或最后一个项目。|
|$pull	|删除与指定查询匹配的所有数组元素。|
|$push	|将项添加到数组。|
|$pullAll	|从数组中删除所有匹配的值。|

### 修饰符

|名称|描述|
|--|--|
|$each	|修改$push和$addToSet运算符以附加多个项目以进行阵列更新。|
|$position	|修改$push运算符以指定数组中添加元素的位置。|
|$slice	|修改$push运算符以限制更新数组的大小。|
|$sort	|修改$push运算符以重新排序存储在数组中的文档。|

### 按位

|名称|描述|
|--|--|
|$bit	|执行按位AND，OR和XOR更新整数值。|

## [聚合管道](https://docs.mongodb.com/manual/reference/operator/aggregation-pipeline/)

### db.collection.aggregate()阶段

|名称|描述|
|--|--|
|$addFields	|向文档添加新字段。类似于 $project，$addFields重塑流中的每个文档; 具体而言，通过向输出文档添加新字段，该文档包含输入文档和新添加字段中的现有字段。|
|$bucket	|根据指定的表达式和存储区边界，将传入的文档分组，称为存储桶。|
|$bucketAuto	|根据指定的表达式将传入的文档分类为特定数量的组（称为存储桶）。自动确定存储桶边界，以尝试将文档均匀地分配到指定数量的存储桶中。|
|$collStats	|返回有关集合或视图的统计信息。|
|$count	|返回聚合管道此阶段的文档数量计数。|
|$facet	|在同一组输入文档的单个阶段内处理多个聚合管道。支持创建能够在单个阶段中跨多个维度或方面表征数据的多面聚合。|
|$geoNear	|基于与地理空间点的接近度返回有序的文档流。集成的功能 $match，$sort以及$limit地理空间数据。输出文档包括附加距离字段，并且可以包括位置标识符字段。|
|$graphLookup	|对集合执行递归搜索。对于每个输出文档，添加一个新的数组字段，其中包含该文档的递归搜索的遍历结果。|
|$group	|按指定的标识符表达式对文档进行分组，并将累加器表达式（如果已指定）应用于每个组。消耗所有输入文档，并为每个不同的组输出一个文档。输出文档仅包含标识符字段，如果指定，则包含累积字段。|
|$indexStats	|返回有关集合的每个索引的使用的统计信息。|
|$limit	|将未修改的前n个文档传递给管道，其中n是指定的限制。对于每个输入文档，输出一个文档（对于前n个文档）或零文档（在前n个文档之后）。|
|$listSessions	|列出活动时间足以传播到system.sessions集合的所有会话。|
|$lookup	|对同一数据库中的另一个集合执行左外连接，以 从“已连接”集合中过滤文档以进行处理。|
|$match	|过滤文档流以仅允许匹配的文档未经修改地传递到下一个管道阶段。 $match使用标准的MongoDB查询。对于每个输入文档，输出一个文档（匹配）或零文档（不匹配）。|
|$out	|将聚合管道的结果文档写入集合。要使用$out舞台，它必须是管道中的最后一个阶段。|
|$project	|重新整形流中的每个文档，例如添加新字段或删除现有字段。对于每个输入文档，输出一个文档。|
|$redact	|通过基于文档本身中存储的信息限制每个文档的内容来重塑流中的每个文档。包含$project和的功能 $match。可用于实现字段级别的编辑。对于每个输入文档，输出一个或零个文档。|
|$replaceRoot	|用指定的嵌入文档替换文档。该操作将替换输入文档中的所有现有字段，包括_id字段。指定嵌入在输入文档中的文档以将嵌入文档提升到顶层。|
|$sample	|从输入中随机选择指定数量的文档。|
|$skip	|跳过前n个文档，其中n是指定的跳过编号，并将未修改的其余文档传递给管道。对于每个输入文档，输出零文档（对于前n个文档）或一个文档（如果在前n个文档之后）。|
|$sort	|按指定的排序键重新排序文档流。只有订单改变; 文件保持不变。对于每个输入文档，输出一个文档。|
|$sortByCount	|根据指定表达式的值对传入文档进行分组，然后计算每个不同组中的文档计数。|
|$unwind	|从输入文档解构数组字段以输出每个元素的文档。每个输出文档都使用元素值替换数组。对于每个输入文档，输出n个文档，其中n是数组元素的数量，对于空数组，可以为零。|

### db.aggregate()阶段(从3.6版开始)

|名称|描述|
|--|--|
|$currentOp	|返回有关MongoDB部署的活动和/或休眠操作的信息。|
|$listLocalSessions	|列出最近在当前连接mongos或mongod 实例上使用的所有活动会话。这些会话可能尚未传播到 system.sessions集合中。|

### 按字母顺序排列的阶段

|名称|描述|
|--|--|
|$addFields	|向文档添加新字段。输出包含输入文档和新添加字段中所有现有字段的文档。|
|$bucket	|根据指定的表达式和存储区边界，将传入的文档分组，称为存储桶。|
|$bucketAuto	|根据指定的表达式将传入的文档分类为特定数量的组（称为存储桶）。自动确定存储桶边界，以尝试将文档均匀地分配到指定数量的存储桶中。|
|$collStats	|返回有关集合或视图的统计信息。|
|$count	|返回聚合管道此阶段的文档数量计数。|
|$currentOp	|返回有关MongoDB部署的活动和/或休眠操作的信息。要运行，请使用该db.aggregate()方法。|
|$facet	|在同一组输入文档的单个阶段内处理多个聚合管道。支持创建能够在单个阶段中跨多个维度或方面表征数据的多面聚合。|
|$geoNear	|基于与地理空间点的接近度返回有序的文档流。集成的功能 $match，$sort以及$limit地理空间数据。输出文档包括附加距离字段，并且可以包括位置标识符字段。|
|$graphLookup	|对集合执行递归搜索。对于每个输出文档，添加一个新的数组字段，其中包含该文档的递归搜索的遍历结果。|
|$group	|按指定的标识符表达式对文档进行分组，并将累加器表达式（如果已指定）应用于每个组。消耗所有输入文档，并为每个不同的组输出一个文档。输出文档仅包含标识符字段，如果指定，则包含累积字段。|
|$indexStats	|返回有关集合的每个索引的使用的统计信息。|
|$limit	|将未修改的前n个文档传递给管道，其中n是指定的限制。对于每个输入文档，输出一个文档（对于前n个文档）或零文档（在前n个文档之后）。|
|$listLocalSessions	|列出最近在当前连接mongos或mongod实例上使用的所有活动会话 。这些会话可能尚未传播到system.sessions集合中。|
|$listSessions	|列出活动时间足以传播到system.sessions集合的所有会话。|
|$lookup	|对同一 数据库中的另一个集合执行左外连接，以从“已连接”集合中过滤文档以进行处理。|
|$match	|过滤文档流以仅允许匹配的文档未经修改地传递到下一个管道阶段。$match 使用标准的MongoDB查询。对于每个输入文档，输出一个文档（匹配）或零文档（不匹配）。|
|$out	|将聚合管道的结果文档写入集合。要使用$out舞台，它必须是管道中的最后一个阶段。|
|$project	|重新整形流中的每个文档，例如添加新字段或删除现有字段。对于每个输入文档，输出一个文档。|
|$redact	|通过基于文档本身中存储的信息限制每个文档的内容来重塑流中的每个文档。包含$project 和的功能$match。可用于实现字段级别的编辑。对于每个输入文档，输出一个或零个文档。|
|$replaceRoot	|用指定的嵌入文档替换文档。该操作将替换输入文档中的所有现有字段，包括_id字段。指定嵌入在输入文档中的文档以将嵌入文档提升到顶层。|
|$sample	|从输入中随机选择指定数量的文档。|
|$skip	|跳过前n个文档，其中n是指定的跳过编号，并将未修改的其余文档传递给管道。对于每个输入文档，输出零文档（对于前n个 文档）或一个文档（如果在前n个文档之后）。|
|$sort	|按指定的排序键重新排序文档流。只有订单改变; 文件保持不变。对于每个输入文档，输出一个文档。|
|$sortByCount	|根据指定表达式的值对传入文档进行分组，然后计算每个不同组中的文档计数。|
|$unwind	|从输入文档解构数组字段以输出每个元素的文档。每个输出文档都使用元素值替换数组。对于每个输入文档，输出n个文档，其中n是数组元素的数量，对于空数组，可以为零。|
